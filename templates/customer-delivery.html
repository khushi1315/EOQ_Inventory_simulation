{% extends "base.html" %}

{% block content %}
<div class="container-fluid py-4">
  <div class="row g-4">

    <!-- Order Tracking -->
    <div class="col-lg-4">
      <div class="Container py-5 card h-100">
        <div class="card-header d-flex justify-content-between">
          <span>Order Tracking</span>
          <a href="#" id="view-all-orders">View all</a>
        </div>
        <div class="card-body">
          <table class="table table-sm" id="orders-table">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Customer</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <!-- Orders will be populated here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Customer Preferences -->
    <div class="col-lg-4">
      <div class="Container py-5 card h-100">
        <div class="card-header">Customer Preferences</div>
        <div class="card-body">
          <div id="preference-content" class="mt-3">
            <div class="btn-group w-100" id="delivery-type-toggle">
              <button class="btn btn-outline-primary" id="same-day-btn">Same-Day</button>
              <button class="btn btn-outline-secondary" id="standard-btn">Standard</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Delivery Cost Calculator -->
      <div class="card mt-4">
        <div class="card-header">Delivery Cost Calculator</div>
        <div class="card-body">
          <form id="cost-form">
            <div class="mb-2">
              <label for="zone-select" class="form-label">Zone</label>
              <select id="zone-select" class="form-select"></select>
            </div>
            <div class="mb-2">
              <label for="distance-input" class="form-label">Distance (km)</label>
              <input type="number" id="distance-input" class="form-control" min="0" step="0.1" />
            </div>
            <button type="submit" class="btn btn-primary w-100">Calculate</button>
          </form>
          <div class="mt-2" id="cost-result"></div>
        </div>
      </div>
    </div>

    <!-- Delivery Zones Map -->
    <div class="col-lg-4">
      <div class="py-5 card h-100">
        <div class="card-header">Delivery Zones</div>
        <div class="card-body">
          <!-- âœ… Latest fixed map height -->
          <div id="delivery-map" style="height: 600px; width: 100%; border-radius: 8px;"></div>
        </div>
      </div>

      <!-- Failed Deliveries -->
      <div class="card mt-4">
        <div class="card-header">Failed Deliveries</div>
        <div class="card-body">
          <table class="table table-sm" id="failed-table">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Date</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <!-- Failed deliveries will be populated here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}

{% block additional_js %}
<link rel="stylesheet" href="/static/css/customer_delivery.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="/static/customer_delivery.js"></script>
{% endblock %}
